\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer}{}\section{L\+S\+T\+D\+A\+Q\+:\+:Ring\+Buffer Class Reference}
\label{class_l_s_t_d_a_q_1_1_ring_buffer}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}


The class to organize ringbuffer.  




{\ttfamily \#include $<$Ring\+Buffer.\+hpp$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_a73c8c103abb16180f8287045a1a3c991}{Ring\+Buffer} ()  throw ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_a93d7015f6225d9e37fddff92aef0a8b9}{$\sim$\+Ring\+Buffer} ()  throw ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
\hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer} \& \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_a018ba5a5649552fe28a226486becf9c8}{operator=} (const \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer} \&)  throw ()
\begin{DoxyCompactList}\small\item\em \char`\"{}=\char`\"{} operator \end{DoxyCompactList}\item 
bool \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_aa74541deb15ec24ed7cf50f22b3d8376}{open} ()
\item 
bool \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_a1c6cee9d706927ec698eca7ee06586b2}{init} ()
\item 
int \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_a6e5dd48d737d2a7cdc8e53baa97900eb}{write} (char $\ast$buf, unsigned int wbytes)
\begin{DoxyCompactList}\small\item\em The function to write data on \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer} in which wbytes\mbox{[}bytes\mbox{]} of data from $\ast$buf will be written. \end{DoxyCompactList}\item 
int \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_a589fb1045d27590cca235e01f313d1e8}{read} (char $\ast$buf)
\begin{DoxyCompactList}\small\item\em The function to read data from \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer}. \end{DoxyCompactList}\item 
unsigned long \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_ac2bbd20a28f7dcf14388648f0eb092cd}{get\+Nw} ()  throw ()
\item 
unsigned long \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_a9d7d68084f66a4fc1c6279171b778807}{get\+Nr} ()  throw ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The class to organize ringbuffer. 

Ringbuffer is a buffer to temporally store data which arrive at socket through T\+C\+P/\+I\+P.


\begin{DoxyParams}{Parameters}
{\em -\/\+Name-\/} & ---Type \+: Description---\\
\hline
{\em $\ast$$\ast$$\ast$$\ast$$\ast$\+For\+\_\+access\+\_\+controll$\ast$$\ast$$\ast$$\ast$$\ast$} & \\
\hline
{\em m\+\_\+mutex} & pthread\+\_\+mutex\+\_\+t \+: ticket to access \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer} object \\
\hline
{\em m\+\_\+cond} & pthread\+\_\+cond\+\_\+t \+: to controll pthread\+\_\+mutex\+\_\+t so that a thread who has ticket can wait for and allow another thread access \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer} object. \\
\hline
{\em m\+\_\+ts\+Wait} & struct timespec \+: time to wait (on write function)\\
\hline
{\em $\ast$$\ast$$\ast$$\ast$$\ast$\+Buffer$\ast$$\ast$$\ast$$\ast$$\ast$} & \\
\hline
{\em m\+\_\+buffer\mbox{[}\+E\+V\+E\+N\+T\+S\+I\+Z\+E$\ast$\+R\+I\+N\+G\+B\+U\+F\+S\+I\+Z\+E\mbox{]}} & unsigned char \+: buffer memory. R\+I\+N\+G\+B\+U\+F\+S\+I\+Z\+E and E\+V\+E\+N\+T\+S\+I\+Z\+E are defined in \hyperlink{_ring_buffer_8hpp}{Ring\+Buffer.\+hpp} and \hyperlink{_config_8hpp}{Config.\+hpp} respectively. \\
\hline
{\em R\+I\+N\+G\+B\+U\+F\+S\+I\+Z\+E} & \#define \+: size of the buffer\mbox{[}events\mbox{]}. \\
\hline
{\em E\+V\+E\+N\+T\+S\+I\+Z\+E} & \#define \+: size of one event\mbox{[}bytes\mbox{]}. More precisely, the length of data which comes from a F\+E\+B kicked by a trigger.\\
\hline
{\em m\+\_\+\+Nm} & const unsigned int \+: N\+O\+T U\+S\+E\+D. T\+O B\+E R\+E\+M\+O\+V\+E\+D. (confession\+: this was used to check initialization by constructor in developing this program)\\
\hline
{\em $\ast$$\ast$$\ast$$\ast$$\ast$\+For\+\_\+position\+\_\+controll$\ast$$\ast$$\ast$$\ast$$\ast$} & \\
\hline
{\em m\+\_\+buf\+Size\+Byte} & unsigned int \+: buffer size\mbox{[}byte\mbox{]} to be used as reference to the position in \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer}. It is initialized as m\+\_\+buf\+Size\+Byte = R\+I\+N\+G\+B\+U\+F\+S\+I\+Z\+E$\ast$\+E\+V\+E\+N\+T\+S\+I\+Z\+E. \\
\hline
{\em m\+\_\+\+Nmw} & unsigned int \+:position\mbox{[}events\mbox{]} to write on the memory \\
\hline
{\em m\+\_\+\+Nmr} & unsigned int \+:position\mbox{[}events\mbox{]} to read from the memory \\
\hline
{\em m\+\_\+woffset} & unsigned int \+:pointer position\mbox{[}bytes\mbox{]} to write on the memory \\
\hline
{\em m\+\_\+roffset} & unsigned int \+:pointer position\mbox{[}bytes\mbox{]} to read from the memory \\
\hline
{\em m\+\_\+remain} & unsigned int \+: \\
\hline
{\em m\+\_\+wbytes} & unsigned int \+:The data size of current event, which have been written to the memory. 0 =$<$ m\+\_\+wbytes $<$ E\+V\+E\+N\+T\+S\+I\+Z\+E.\\
\hline
{\em $\ast$$\ast$$\ast$$\ast$$\ast$\+Total\+\_\+history$\ast$$\ast$$\ast$$\ast$$\ast$} & \\
\hline
{\em m\+\_\+\+Nw} & unsigned long \+: Total number of events written to the memory \\
\hline
{\em m\+\_\+\+Nr} & unsigned long \+: Total number of events read from the memory \\
\hline
\end{DoxyParams}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer_a73c8c103abb16180f8287045a1a3c991}{}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}!Ring\+Buffer@{Ring\+Buffer}}
\index{Ring\+Buffer@{Ring\+Buffer}!L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}
\subsubsection[{Ring\+Buffer()}]{\setlength{\rightskip}{0pt plus 5cm}L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer\+::\+Ring\+Buffer (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) throw  ) }\label{class_l_s_t_d_a_q_1_1_ring_buffer_a73c8c103abb16180f8287045a1a3c991}


Constructor. 

\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer_a93d7015f6225d9e37fddff92aef0a8b9}{}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}!````~Ring\+Buffer@{$\sim$\+Ring\+Buffer}}
\index{````~Ring\+Buffer@{$\sim$\+Ring\+Buffer}!L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}
\subsubsection[{$\sim$\+Ring\+Buffer()}]{\setlength{\rightskip}{0pt plus 5cm}L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer\+::$\sim$\+Ring\+Buffer (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) throw  ) \hspace{0.3cm}{\ttfamily [virtual]}}\label{class_l_s_t_d_a_q_1_1_ring_buffer_a93d7015f6225d9e37fddff92aef0a8b9}


Destructor. 



\subsection{Member Function Documentation}
\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer_a9d7d68084f66a4fc1c6279171b778807}{}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}!get\+Nr@{get\+Nr}}
\index{get\+Nr@{get\+Nr}!L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}
\subsubsection[{get\+Nr()}]{\setlength{\rightskip}{0pt plus 5cm}unsigned long L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer\+::get\+Nr (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) throw  ) }\label{class_l_s_t_d_a_q_1_1_ring_buffer_a9d7d68084f66a4fc1c6279171b778807}
\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer_ac2bbd20a28f7dcf14388648f0eb092cd}{}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}!get\+Nw@{get\+Nw}}
\index{get\+Nw@{get\+Nw}!L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}
\subsubsection[{get\+Nw()}]{\setlength{\rightskip}{0pt plus 5cm}unsigned long L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer\+::get\+Nw (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) throw  ) }\label{class_l_s_t_d_a_q_1_1_ring_buffer_ac2bbd20a28f7dcf14388648f0eb092cd}
\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer_a1c6cee9d706927ec698eca7ee06586b2}{}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}!init@{init}}
\index{init@{init}!L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}
\subsubsection[{init()}]{\setlength{\rightskip}{0pt plus 5cm}bool L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer\+::init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{class_l_s_t_d_a_q_1_1_ring_buffer_a1c6cee9d706927ec698eca7ee06586b2}
\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer_aa74541deb15ec24ed7cf50f22b3d8376}{}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}!open@{open}}
\index{open@{open}!L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}
\subsubsection[{open()}]{\setlength{\rightskip}{0pt plus 5cm}bool L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer\+::open (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{class_l_s_t_d_a_q_1_1_ring_buffer_aa74541deb15ec24ed7cf50f22b3d8376}
\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer_a018ba5a5649552fe28a226486becf9c8}{}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}!operator=@{operator=}}
\index{operator=@{operator=}!L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}
\subsubsection[{operator=(const Ring\+Buffer \&)}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ring\+Buffer} \& L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer\+::operator= (
\begin{DoxyParamCaption}
\item[{const {\bf Ring\+Buffer} \&}]{rb}
\end{DoxyParamCaption}
) throw  ) }\label{class_l_s_t_d_a_q_1_1_ring_buffer_a018ba5a5649552fe28a226486becf9c8}


\char`\"{}=\char`\"{} operator 

\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer_a589fb1045d27590cca235e01f313d1e8}{}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}!read@{read}}
\index{read@{read}!L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}
\subsubsection[{read(char $\ast$buf)}]{\setlength{\rightskip}{0pt plus 5cm}int L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer\+::read (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{buf}
\end{DoxyParamCaption}
)}\label{class_l_s_t_d_a_q_1_1_ring_buffer_a589fb1045d27590cca235e01f313d1e8}


The function to read data from \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer}. 

Whole size of one event data is read from m\+\_\+buffer. If there is no new data in m\+\_\+buffer, the function ends without reading.

Procedure \+:
\begin{DoxyItemize}
\item If there is no new unread data, the function ends.
\item Lock mutex
\item read one event starts from m\+\_\+roffset in m\+\_\+buffer.
\item increment values (m\+\_\+\+Nr, m\+\_\+\+Nmr and m\+\_\+roffset).
\item If offset in m\+\_\+roffset reaches at the end of m\+\_\+buffer, resets m\+\_\+\+Nmr and m\+\_\+roffset. 
\end{DoxyItemize}\hypertarget{class_l_s_t_d_a_q_1_1_ring_buffer_a6e5dd48d737d2a7cdc8e53baa97900eb}{}\index{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}!write@{write}}
\index{write@{write}!L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer@{L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer}}
\subsubsection[{write(char $\ast$buf, unsigned int wbytes)}]{\setlength{\rightskip}{0pt plus 5cm}int L\+S\+T\+D\+A\+Q\+::\+Ring\+Buffer\+::write (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{buf, }
\item[{unsigned int}]{wbytes}
\end{DoxyParamCaption}
)}\label{class_l_s_t_d_a_q_1_1_ring_buffer_a6e5dd48d737d2a7cdc8e53baa97900eb}


The function to write data on \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer} in which wbytes\mbox{[}bytes\mbox{]} of data from $\ast$buf will be written. 

Data with any length up to E\+V\+E\+N\+T\+S\+I\+Z\+E can be written if there is enough empty space. \char`\"{}empty\char`\"{} space means the buffer memory which is not written yet or already read by \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer_a589fb1045d27590cca235e01f313d1e8}{read()} function. Data doesn\textquotesingle{}t need to be exact within one event. Data which contains parts of two events can be treated too.

Procedure\+:
\begin{DoxyItemize}
\item Lock mutex so that no other threads can access \hyperlink{class_l_s_t_d_a_q_1_1_ring_buffer}{Ring\+Buffer}.
\item Makes sure there is enough space to write ~\newline
 m\+\_\+\+Nw should not be larger than m\+\_\+\+Nr + R\+I\+N\+G\+B\+U\+F\+S\+I\+Z\+E, otherwise the unread data in buffer is overwritten. If the condition will be violated by writing data, this function stops and waits for one more data to be read.
\item Writes data in m\+\_\+buffer buffer memory~\newline
 The data buf with wbytes of lengh is written to m\+\_\+buffer from m\+\_\+woffset position. After writing, m\+\_\+woffset and m\+\_\+wbytes will be increased by wbytes. ã€€\+If the data to write doesn\textquotesingle{}t include the end of a event (m\+\_\+wbytes + wbytes$<$ E\+V\+E\+N\+T\+S\+I\+Z\+E), data will just be written. Otherwise, data will be written in following way.~\newline
 m\+\_\+\+Nw and m\+\_\+\+Nmw will be counted up as well as data is written in buffer and m\+\_\+woffset will be shifted by wbytes.\+m\+\_\+wbytes also be shifted so that it indicates to which position in the dataformat has been written. If the position in the memory to write data includes the end of buffer memory, the process includes reset of the offset position. This means m\+\_\+\+Nmw=0 and m\+\_\+woffset = m\+\_\+remain. m\+\_\+remain is the residure to write after writing data until the end position of buffer.
\item Unlock mutex to access. 
\end{DoxyItemize}

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{_ring_buffer_8hpp}{Ring\+Buffer.\+hpp}\item 
\hyperlink{_ring_buffer_8cpp}{Ring\+Buffer.\+cpp}\end{DoxyCompactItemize}
